import"../chunks/DsnmJJEf.js";import"../chunks/CjiiVrWd.js";import{o as R}from"../chunks/Kmuhr-ln.js";import{H as S,W as T,p as q,f as b,a as l,b as E,j as s,e as k,g as u,t as F,c as h,r as m,s as x,h as G,i as J}from"../chunks/D1A2w5RJ.js";import{b as K,e as p}from"../chunks/BuqVqMeC.js";import{i as A}from"../chunks/Bjz8fhAO.js";import{s as N}from"../chunks/BRAZgn98.js";import{i as P}from"../chunks/D4z-0_Bc.js";import{g as Q}from"../chunks/DP-STAQS.js";import{u as V}from"../chunks/BOzFjxGZ.js";function X(g,c,n,d,o){S&&T();var i=c.$$slots?.[n],v=!1;i===!0&&(i=c.children,v=!0),i===void 0||i(g,v?()=>d:d)}const Y="data:image/svg+xml,%3csvg%20xmlns='http://www.w3.org/2000/svg'%20width='107'%20height='128'%20viewBox='0%200%20107%20128'%3e%3ctitle%3esvelte-logo%3c/title%3e%3cpath%20d='M94.157%2022.819c-10.4-14.885-30.94-19.297-45.792-9.835L22.282%2029.608A29.92%2029.92%200%200%200%208.764%2049.65a31.5%2031.5%200%200%200%203.108%2020.231%2030%2030%200%200%200-4.477%2011.183%2031.9%2031.9%200%200%200%205.448%2024.116c10.402%2014.887%2030.942%2019.297%2045.791%209.835l26.083-16.624A29.92%2029.92%200%200%200%2098.235%2078.35a31.53%2031.53%200%200%200-3.105-20.232%2030%2030%200%200%200%204.474-11.182%2031.88%2031.88%200%200%200-5.447-24.116'%20style='fill:%23ff3e00'/%3e%3cpath%20d='M45.817%20106.582a20.72%2020.72%200%200%201-22.237-8.243%2019.17%2019.17%200%200%201-3.277-14.503%2018%2018%200%200%201%20.624-2.435l.49-1.498%201.337.981a33.6%2033.6%200%200%200%2010.203%205.098l.97.294-.09.968a5.85%205.85%200%200%200%201.052%203.878%206.24%206.24%200%200%200%206.695%202.485%205.8%205.8%200%200%200%201.603-.704L69.27%2076.28a5.43%205.43%200%200%200%202.45-3.631%205.8%205.8%200%200%200-.987-4.371%206.24%206.24%200%200%200-6.698-2.487%205.7%205.7%200%200%200-1.6.704l-9.953%206.345a19%2019%200%200%201-5.296%202.326%2020.72%2020.72%200%200%201-22.237-8.243%2019.17%2019.17%200%200%201-3.277-14.502%2017.99%2017.99%200%200%201%208.13-12.052l26.081-16.623a19%2019%200%200%201%205.3-2.329%2020.72%2020.72%200%200%201%2022.237%208.243%2019.17%2019.17%200%200%201%203.277%2014.503%2018%2018%200%200%201-.624%202.435l-.49%201.498-1.337-.98a33.6%2033.6%200%200%200-10.203-5.1l-.97-.294.09-.968a5.86%205.86%200%200%200-1.052-3.878%206.24%206.24%200%200%200-6.696-2.485%205.8%205.8%200%200%200-1.602.704L37.73%2051.72a5.42%205.42%200%200%200-2.449%203.63%205.79%205.79%200%200%200%20.986%204.372%206.24%206.24%200%200%200%206.698%202.486%205.8%205.8%200%200%200%201.602-.704l9.952-6.342a19%2019%200%200%201%205.295-2.328%2020.72%2020.72%200%200%201%2022.237%208.242%2019.17%2019.17%200%200%201%203.277%2014.503%2018%2018%200%200%201-8.13%2012.053l-26.081%2016.622a19%2019%200%200%201-5.3%202.328'%20style='fill:%23fff'/%3e%3c/svg%3e";var Z=b('<link rel="icon"/>'),t0=b('<button class="ml-auto w-fit px-3 py-1 rounded font-semibold hover:bg-secondary-700 hover:text-black shadow border-2 border-secondary-400 bg-secondary-400 text-black transition-colors duration-200">Admin</button>'),e0=b('<button class="px-4 py-2 rounded font-semibold hover:bg-secondary-700 hover:text-black shadow border-2 border-secondary-400 bg-secondary-400 text-black transition-colors duration-200">Login with Discord</button>'),o0=b('<button class="ml-auto w-fit px-3 py-1 rounded font-semibold hover:bg-secondary-700 hover:text-black shadow border-2 border-secondary-400 bg-secondary-400 text-black transition-colors duration-200">My sheets</button>'),a0=b('<div class="flex flex-col w-full h-full bg-background-900"><div class="px-6 py-3 grid grid-cols-3 items-center shadow-lg border-b-4 border-secondary-400 bg-background-900"><div><!></div> <button type="button" class="align-self-center text-center font-bold text-2xl tracking-widest uppercase font-serif text-secondary-400 hover:underline focus:outline-none" style="display: block; background: none; border: none; cursor: pointer;">World of Dark West</button> <!></div> <div class="flex grow flex-1 overflow-auto"><!></div></div>');function v0(g,c){q(c,!1);let n=k(!1),d=k(!1),o=k(null);R(async()=>{const t=localStorage.getItem("jwt");if(t){s(n,!0);try{const f=await fetch("http://direct.laminatedconcrete.com:9000/api/user/info",{headers:{Authorization:`Bearer ${t}`},credentials:"include"});if(f.ok){const a=await f.json();s(d,!!a.isAdmin),s(o,Array.isArray(a.sheets)?a.sheets:[]),V.set({isAdmin:!!a.isAdmin,sheets:u(o),user:a.user??null,characters:u(o)?.map(r=>({id:r.character_id,name:r.name,type:r.character_type}))??[]})}else f.status===401&&(s(n,!1),s(o,null))}catch{s(n,!1),s(o,null)}}});const i="1399163131133169794",v="http://localhost:5173/callback",L="https://discord.com/oauth2/authorize",M="identify",W="code";function j(){const t=`${L}?client_id=${i}&redirect_uri=${encodeURIComponent(v)}&response_type=${W}&scope=${M}`;window.location.href=t}P();var y=a0();K(t=>{var e=Z();F(()=>N(e,"href",Y)),l(t,e)});var _=h(y),w=h(_),B=h(w);{var $=t=>{var e=t0();p("click",e,()=>window.location.href="/admin"),l(t,e)};A(B,t=>{u(d)&&t($)})}m(w);var I=x(w,2),z=x(I,2);{var O=t=>{var e=e0();p("click",e,j),l(t,e)},C=t=>{var e=G(),f=J(e);{var a=r=>{var D=o0();p("click",D,()=>window.location.href="/sheets"),l(r,D)};A(f,r=>{u(o)&&r(a)},!0)}l(t,e)};A(z,t=>{u(n)?t(C,!1):t(O)})}m(_);var U=x(_,2),H=h(U);X(H,c,"default",{}),m(U),m(y),p("click",I,()=>Q("/")),l(g,y),E()}export{v0 as component};
